"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8982],{23443:(Z,T,s)=>{s.d(T,{N:()=>f});var p,g=s(15861),m=s(54931),M=s(20553),i=s(19212);class f{constructor(){}fetchBaseTokenUSDPrice(){return(0,g.Z)(function*(){return(yield(0,m.qo)(M.N.api.endpoint)("query")({status:[{where:{chain_id:{_eq:M.N.chain.chainId}}},{base_token:!0,base_token_usd:!0}]})).status[0].base_token_usd||0})()}}(p=f).\u0275fac=function(h){return new(h||p)},p.\u0275prov=i.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})},48982:(Z,T,s)=>{s.r(T),s.d(T,{MarketsPage:()=>v});var k,g=s(15861),m=s(96814),M=s(60095),i=s(93800),p=s(54931),f=s(20553),P=s(81360),h=s(14391),d=s(35768),A=s(22280),e=s(19212),b=s(23443),E=s(98065),O=s(85219);function U(o,t){1&o&&(e.TgZ(0,"ion-title"),e._uU(1," CFT-20 Trading Markets (Deprecated) "),e.qZA())}function x(o,t){1&o&&(e.TgZ(0,"ion-title"),e._uU(1," CFT-20 Trading Markets "),e.qZA())}function C(o,t){1&o&&(e.TgZ(0,"h1"),e._uU(1,"This marketplace is deprecated, and has risks of "),e.TgZ(2,"a",13),e._uU(3,"double buys"),e.qZA(),e._uU(4,". Use it to handle old listings, but use "),e.TgZ(5,"a",14),e._uU(6,"the new marketplace protocol"),e.qZA(),e._uU(7," for future listings. "),e.qZA()),2&o&&(e.xp6(5),e.Q6J("href","/app/markets",e.LSH))}function D(o,t){1&o&&(e.TgZ(0,"div"),e._UZ(1,"ion-progress-bar",15),e.qZA())}function I(o,t){if(1&o&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2),e.qZA(),e.TgZ(3,"span",18),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&o){const n=e.oxw();e.xp6(2),e.hij(" ",n.baseToken.base_token,"/USD "),e.xp6(2),e.hij(" $",e.xi3(5,2,n.baseToken.base_token_usd,"1.2-2")," ")}}function L(o,t){if(1&o){const n=e.EpF();e.TgZ(0,"div",19)(1,"div")(2,"ion-input",20,21),e.NdJ("input",function(){e.CHM(n);const a=e.MAs(3);e.oxw();const u=e.MAs(15);return e.KtG(u.filterGlobal(a.value,"contains"))}),e._UZ(4,"ion-icon",22),e.qZA()()()}}function y(o,t){1&o&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"\xa0"),e.qZA(),e.TgZ(3,"th",23),e._uU(4,"Market "),e._UZ(5,"p-sortIcon",24),e.qZA(),e.TgZ(6,"th",25),e._uU(7,"Token "),e._UZ(8,"p-sortIcon",26),e.qZA(),e.TgZ(9,"th",27),e._uU(10,"Listings "),e._UZ(11,"p-sortIcon",28),e.qZA(),e.TgZ(12,"th",29),e._uU(13,"Token Price "),e._UZ(14,"p-sortIcon",30),e.qZA(),e.TgZ(15,"th",31),e._uU(16,"Volume 24h"),e._UZ(17,"p-sortIcon",32),e.qZA(),e.TgZ(18,"th"),e._uU(19,"\xa0"),e.qZA()())}function R(o,t){if(1&o&&e._UZ(0,"img",41),2&o){const n=e.oxw().$implicit;e.Q6J("src",n.content_path,e.LSH)}}function S(o,t){1&o&&e._UZ(0,"img",42)}function K(o,t){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",43),e.NdJ("click",function(a){e.CHM(n);const u=e.oxw().$implicit,l=e.oxw();return e.KtG(l.listSale(a,u.ticker))}),e._uU(1,"Sell"),e.qZA()}}const q=(o,t)=>["/app/market",o,t];function B(o,t){if(1&o&&(e.TgZ(0,"tr",33)(1,"td",34)(2,"div",35),e.YNc(3,R,1,1,"img",36)(4,S,1,0,"img",37),e.qZA()(),e.TgZ(5,"td",38),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td",39),e._uU(10),e.qZA(),e.TgZ(11,"td",39),e._uU(12),e.ALo(13,"tokenDecimals"),e.ALo(14,"number"),e.ALo(15,"tokenDecimals"),e.qZA(),e.TgZ(16,"td",39),e._uU(17),e.ALo(18,"number"),e.ALo(19,"tokenDecimals"),e.ALo(20,"number"),e.ALo(21,"tokenDecimals"),e.qZA(),e.TgZ(22,"td"),e.YNc(23,K,2,0,"ion-button",40),e.qZA()()),2&o){const n=t.$implicit,r=e.oxw();let a;e.Q6J("routerLink",e.WLB(32,q,"v"+r.version,n.ticker)),e.xp6(3),e.Q6J("ngIf",n.content_path),e.xp6(1),e.Q6J("ngIf",!n.content_path),e.xp6(2),e.hij("",n.ticker," / ATOM"),e.xp6(2),e.Oqu(n.name),e.xp6(2),e.Oqu((null!==(a=n.marketplace_cft20_details)&&void 0!==a?a:n.token_open_positions).length),e.xp6(2),e.AsE("",e.xi3(13,11,n.last_price_base,n.decimals)," ATOM ($",e.xi3(14,14,r.baseToken.base_token_usd*e.xi3(15,17,n.last_price_base,n.decimals),"1.2-6"),")"),e.xp6(5),e.AsE(" ",e.xi3(18,20,e.xi3(19,23,n.volume_24_base,6),"1.2-6")," ATOM ($",e.xi3(20,26,r.baseToken.base_token_usd*e.xi3(21,29,n.volume_24_base,6),"1.2-6"),") "),e.xp6(6),e.Q6J("ngIf",null==n.token_holders[0]?null:n.token_holders[0].amount)}}function W(o,t){1&o&&(e.TgZ(0,"tr")(1,"td",44),e._uU(2,"No markets found"),e.qZA()())}const w=()=>({"min-width":"40rem"}),F=()=>["name","ticker"];class v{constructor(t,n,r,a){this.activatedRoute=t,this.priceService=n,this.modalCtrl=r,this.walletService=a,this.isLoading=!0,this.userAddress="",this.tokens=null,this.offset=0,this.limit=50,this.lastFetchCount=0,this.version=1,this.lastFetchCount=this.limit}ngOnInit(){var t=this;return(0,g.Z)(function*(){t.activatedRoute.params.subscribe(function(){var n=(0,g.Z)(function*(r){(yield t.walletService.isConnected())&&(t.userAddress=(yield t.walletService.getAccount()).address),t.isLoading=!0;const u=yield(0,p.qo)(f.N.api.endpoint)("query")({token:[{offset:t.offset,limit:t.limit,order_by:[{volume_24_base:"desc_nulls_last"}]},{id:!0,transaction:{hash:!0},token_open_positions:[{where:{is_filled:{_eq:!1},is_cancelled:{_eq:!1}}},{id:!0}],token_holders:[{where:{address:{_eq:t.userAddress}}},{amount:!0}],current_owner:!0,content_path:!0,name:!0,ticker:!0,max_supply:!0,circulating_supply:!0,decimals:!0,launch_timestamp:!0,last_price_base:!0,volume_24_base:!0,date_created:!0}],status:[{where:{chain_id:{_eq:f.N.chain.chainId}}},{base_token:!0,base_token_usd:!0}]});t.tokens=u.token,t.baseToken=u.status[0],t.isLoading=!1});return function(r){return n.apply(this,arguments)}}())})()}listSale(t,n){var r=this;return(0,g.Z)(function*(){t.stopPropagation(),(yield r.modalCtrl.create({keyboardClose:!0,backdropDismiss:!0,component:A.t,componentProps:{ticker:n}})).present()})()}customSort(t){var n,r;"listings"==t.field&&(null===(r=t.data)||void 0===r||r.sort((a,u)=>{let l=a.token_open_positions.length,_=u.token_open_positions.length,c=null;return c=null==l&&null!=_?-1:null!=l&&null==_?1:null==l&&null==_?0:"string"==typeof l&&"string"==typeof _?l.localeCompare(_):l<_?-1:l>_?1:0,t.order*c}));null===(n=t.data)||void 0===n||n.sort((a,u)=>{let l=a[t.field],_=u[t.field],c=null;return c=null==l&&null!=_?-1:null!=l&&null==_?1:null==l&&null==_?0:"string"==typeof l&&"string"==typeof _?l.localeCompare(_):l<_?-1:l>_?1:0,t.order*c})}}(k=v).\u0275fac=function(t){return new(t||k)(e.Y36(h.gz),e.Y36(b.N),e.Y36(i.IN),e.Y36(E.X))},k.\u0275cmp=e.Xpm({type:k,selectors:[["app-markets"]],standalone:!0,features:[e.jDz],decls:20,vars:15,consts:[["fullscreen","true"],["size","12","offset","0","size-md","12","offset-md","0","size-md","10","offset-md","1","size-xl","8","offset-xl","2"],[1,"no-shadow"],["slot","start"],[4,"ngIf"],[1,"aligned","main-content"],["class","base-token-price",4,"ngIf"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} markets","styleClass","token-list","sortField","volume_24_base",3,"customSort","value","tableStyle","paginator","rows","showCurrentPageReport","globalFilterFields","sortOrder","sortFunction"],["data",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["href","https://medium.com/@asteroidprotocol/asteroid-market-double-buy-solution-1a1312216f37"],[3,"href"],["type","indeterminate"],[1,"base-token-price"],[1,"ticker"],[1,"price"],[1,"flex","search"],["fill","outline","label","Search","labelPlacement","stacked","placeholder","Name or ticker",3,"input"],["textInput",""],["slot","end","name","search-outline","aria-hidden","true"],["pSortableColumn","ticker","pFrozenColumn",""],["field","ticker"],["pSortableColumn","name"],["field","name"],["pSortableColumn","listings"],["field","listings"],["pSortableColumn","last_price_base"],["field","last_price_base"],["pSortableColumn","volume_24_base"],["field","volume_24_base"],[3,"routerLink"],[1,"token-logo"],[1,"image"],[3,"src",4,"ngIf"],["class","no-logo","src","../../assets/logo/a-white-on-transparent-250.png",4,"ngIf"],["pFrozenColumn",""],[1,"mono"],["fill","outline","color","warning",3,"click",4,"ngIf"],[3,"src"],["src","../../assets/logo/a-white-on-transparent-250.png",1,"no-logo"],["fill","outline","color","warning",3,"click"],["colspan","4"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content",0)(1,"ion-grid")(2,"ion-row")(3,"ion-col",1)(4,"ion-header",2)(5,"ion-toolbar")(6,"ion-buttons",3),e._UZ(7,"ion-menu-button"),e.qZA(),e.YNc(8,U,2,0,"ion-title",4)(9,x,2,0,"ion-title",4),e.qZA()(),e.TgZ(10,"div",5),e.YNc(11,C,8,1,"h1",4)(12,D,2,0,"div",4)(13,I,6,5,"div",6),e.TgZ(14,"p-table",7,8),e.NdJ("sortFunction",function(a){return n.customSort(a)}),e.YNc(16,L,5,0,"ng-template",9)(17,y,20,0,"ng-template",10)(18,B,24,35,"ng-template",11)(19,W,3,0,"ng-template",12),e.qZA()()()()()()),2&t&&(e.xp6(8),e.Q6J("ngIf",1==n.version),e.xp6(1),e.Q6J("ngIf",2==n.version),e.xp6(2),e.Q6J("ngIf",1==n.version),e.xp6(1),e.Q6J("ngIf",n.isLoading),e.xp6(1),e.Q6J("ngIf",!n.isLoading),e.xp6(1),e.Q6J("customSort",!0)("value",n.tokens)("tableStyle",e.DdM(13,w))("paginator",!0)("rows",50)("showCurrentPageReport",!0)("globalFilterFields",e.DdM(14,F))("sortOrder",-1))},dependencies:[i.Pc,i.YG,i.Sm,i.wI,i.W2,i.jY,i.Gu,i.gu,i.pK,i.fG,i.X7,i.Nd,i.wd,i.sr,i.j9,i.YI,m.ez,m.O5,m.JJ,M.u5,P.u,h.rH,d.U$,d.iA,O.jx,d.lQ,d.on,d.fz],styles:[".list[_ngcontent-%COMP%]{text-align:left}@media only screen and (max-width: 900px){.list[_ngcontent-%COMP%]{text-align:center}}.filter[_ngcontent-%COMP%]{margin-top:-15px;color:#888}.token-holdings-list[_ngcontent-%COMP%]{margin-left:0;max-width:600px;margin-bottom:50px}.token-holdings-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:5px;cursor:pointer;border-bottom:1px solid rgba(119,119,119,.2)}.token-holdings-list[_ngcontent-%COMP%]   .item.interactable[_ngcontent-%COMP%]{color:#ccc}.token-holdings-list[_ngcontent-%COMP%]   .item.interactable[_ngcontent-%COMP%]:hover{color:#57aaa7}.token-holdings-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{text-align:right}"]})}}]);